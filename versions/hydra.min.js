(function(){"use strict";function t(){var t=+new Date+"",e=Math.floor(999999*Math.random())+1;return t+"_"+e}function e(t){var e,n;if(Object.keys)e=Object.keys(t).length;else{e=0;for(n in t)c(t,n)&&e++}return e}function n(t){return A.toString.call(t)}function r(t){return"[object Function]"===n(t)}function o(t){return"[object Array]"===n(t)}function i(t){O=t}function u(t){M=t}function s(t,e){return[].slice.call(t,e||0)}function c(t,e){return t.hasOwnProperty(e)}function f(t,e,n,r,o){var i,u;return i=g[e],o&&t.isModuleStarted(e,n)&&t.stop(e,n),typeof i!==b&&(u=p(e),i.instances[n]=u,u.__instance_id__=n,typeof r!==b?u.init(r):u.init()),u}function a(t,e){var n;for(n in e)c(e,n)&&(t[n]=e[n]);return t}function l(t,e,n,r){t[e]=function(t,e){return function(){var r=s(arguments,0);try{return e.apply(this,r)}catch(o){return x.log(n,t,o),!1}}}(e,r)}function _(t,e){var n,r=[];if(t!==void 0)for(n in t)c(t,n)&&n===e&&(r=t[n]);return r}function d(t,e){var n,r;return n=g[t].creator(e),n.__module_id__=t,r=n.init||function(){},n.__action__=e,n.events=n.events||{},n.init=function(){var t=s(arguments,0).concat(m);e.subscribe(n),r.apply(this,t)},n.handleAction=function(t){var e=this.events[t.type];typeof e!==b&&e.call(this,t)},n.onDestroy=n.onDestroy||function(){},n.destroy=function(){this.onDestroy(),e.unsubscribe(n)},n}function p(t){var e,n;if(typeof g[t]===b)throw Error("The module "+t+" is not registered!");if(e=d(t,B),!O)for(n in e)c(e,n)&&r(e[n])&&l(e,n,t,e[n]);return e}function h(){return x}function v(t){x=t}var y,b,g,m,S,M,w,E,I,j,O,x,D,B,T,k,A;"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),k="object"==typeof exports&&"object"==typeof module&&"object"==typeof module.exports&&"function"==typeof require,b="undefined",A=Object.prototype,y=this,S=null,w=!1,g={},E="3.1.3",O=w,M=w,T={global:{}},B={subscribers:function(t,e){return _(T[t],e)},_getChannelEvents:function(t,e){return T[t]===void 0&&(T[t]={}),T[t][e]===void 0&&(T[t][e]=[]),T[t][e]},_addSubscribers:function(t,e,n){var r;for(r in t)c(t,r)&&this.subscribeTo(e,r,t[r],n)},unsubscribeFrom:function(t,e,n){for(var r,o=this._getChannelEvents(t,e),i=o.length-1;i>=0;i--)r=o[i],r.subscriber===n&&o.splice(i,1)},subscribeTo:function(t,e,n,r){var o=this._getChannelEvents(t,e);o.push({subscriber:r,handler:n})},subscribe:function(t){var e,n=t.events;if(!t||n===void 0)return!1;for(e in n)c(n,e)&&(T[e]===void 0&&(T[e]={}),this._addSubscribers(n[e],e,t));return!0},_removeSubscribers:function(t,e){var n,r=0,o=0;if(typeof t!==b)for(n=t.length;n>r;r++)t[r].subscriber===e&&(o++,t.splice(r,1));return o},_removeSubscribersPerEvent:function(t,e,n){var r,o,i,u,s=0;for(r in t)c(t,r)&&(o=r.split(":"),i=e,u=r,"global"===o[0]&&(i=o[0],u=o[1]),s+=this._removeSubscribers(T[i][u],n));return s},unsubscribe:function(t){var e,n=0,r=t.events;if(!t||r===void 0)return!1;for(e in r)c(r,e)&&(T[e]===void 0&&(T[e]={}),n=this._removeSubscribersPerEvent(r[e],e,t));return n>0},_avoidBlockUI:function(t,e,n,r){var o,i=t.concat();setTimeout(function u(){var t=+new Date;do o=i.shift(),o.handler.call(o.subscriber,e),O&&x.log(n,r,o);while(i.length>0&&50>+new Date-t);i.length>0&&setTimeout(u,25)},25)},publish:function(t,e,n){var r,o,i=this.subscribers(t,e).slice(),u=i.length;if(0===u)return!1;if(M)this._avoidBlockUI(i,n,t,e);else for(r=0;u>r;r++)o=i[r],o.handler.call(o.subscriber,n),O&&x.log(t,e,o);return!0},reset:function(){T={global:{}}}},x=y.console||{log:function(){}},D=function(){},D.prototype={type:"Module",getInstance:p,register:function(t,e){return g[t]=new I(t,e),g[t]},_setSuper:function(t,e){t.__super__={},t.__super__.__instance__=e,t.__super__.__call__=function(e,n){for(var r=this;c(r,e)===w;)r=r.__instance__.__super__;r[e].apply(t,n)}},_callInSuper:function(t){return function(){var e=s(arguments,0);t.apply(this,e)}},_mergeModuleExtended:function(t,e){var n;for(n in e)c(e,n)&&(typeof t.__super__!==b&&r(t[n])&&(t.__super__[n]=this._callInSuper(t[n])),t[n]=e[n])},_mergeModuleBase:function(t,e){var n;for(n in e)c(e,n)&&"__super__"!==n&&(t[n]=e[n])},_merge:function(t,e){var n={};return this._setSuper(n,t),this._mergeModuleBase(n,t),this._mergeModuleExtended(n,e),n},extend:function(t,e,n){var r,o,i,u,s,c,f;return f=this,r=g[t],o=t,i=function(){},"string"==typeof e?(o=e,i=n):i=e,typeof r!==b?(s=i(B),u=r.creator(B),g[o]=new I(o,function(t){return c=f._merge(u,s),c.__action__=t,c}),g[o]):void 0},setInstance:function(t,e,n){var r=g[t];if(!r)throw Error("The module "+t+" is not registered!");return r.instances[e]=n,r},setVars:function(t){m=typeof m!==b?a(m,t):t},getVars:function(){return a({},m)},_multiModuleStart:function(e,n,r,i){var u,s,c,a,l,_;for(o(n)&&(u=n.slice(0)),o(r)&&(s=r.slice(0)),o(i)&&(c=i.slice(0)),a=0,l=e.length;l>a;a++)_=e[a],n=u&&u[a]||t(),r=s&&s[a]||r,i=c&&c[a]||i,f(this,_,n,r,i)},_singleModuleStart:function(e,n,r,o){"string"!=typeof n&&(r=n,o=r,n=t()),f(this,e,n,r,o)},start:function(t,e,n,r){var i=o(t);i?this._multiModuleStart(t.slice(0),e,n,r):this._singleModuleStart(t,e,n,r)},isModuleStarted:function(t,n){var r=!1;return r=typeof n===b?typeof g[t]!==b&&e(g[t].instances)>0:typeof g[t]!==b&&typeof g[t].instances[n]!==b},startAll:function(){var e,n;for(e in g)c(g,e)&&(n=g[e],typeof n!==b&&this.start(e,t()))},_multiModuleStop:function(t){var e,n,r=t.instances;for(e in r)c(r,e)&&(n=r[e],typeof t!==b&&typeof n!==b&&n.destroy())},_singleModuleStop:function(t,e,n){var r=t.instances[n];typeof t!==b&&typeof r!==b&&r.destroy()},stop:function(t,e){var n;return n=g[t],typeof n===b?!1:(typeof e!==b?this._singleModuleStop(n,t,e):this._multiModuleStop(n),!0)},_stopOneByOne:function(t,e){var n;for(n in t)c(t,n)&&this.stop(e,n)},stopAll:function(){var t;for(t in g)c(g,t)&&typeof g[t]!==b&&this._stopOneByOne(g[t].instances,t)},_delete:function(t){typeof g[t]!==b&&delete g[t]},remove:function(t){var e=g[t];if(typeof e===b)return null;if(typeof e!==b)try{return e}finally{this._delete(t)}return null}},j=function(){},j.version=E,j.bus=B,j.errorHandler=h,j.setErrorHandler=v,j.module=new D,j.setUnblockUI=u,j.setDebug=i,j.getDebug=function(){return O},j.extend=function(t,e){this[t]=typeof this[t]===b?e:a(this[t],e)},j.noConflict=function(t,e,n){return typeof this[t]!==b?(e[n]=this[t],!0):!1},I=function(t,e){if(typeof e===b)throw Error("Something goes wrong!");this.creator=e,this.instances={},this.sModuleId=t},I.prototype={start:function(t){return j.module.start(this.sModuleId,void 0,t),this},extend:function(t,e){return j.module.extend(this.sModuleId,t,e),this},stop:function(){return j.module.stop(this.sModuleId),this}},y.Hydra=j,k?module.exports=j:"undefined"!=typeof define&&define("hydra",[],function(){return j})}).call(this);