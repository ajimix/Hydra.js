(function(v,D,s){var n,C,i,u,d,m,x,h,g,q,y,B,E,f,z,e,b,r;if(D===s){D=v}m=null;x=false;h=true;C=v.document;n={};i=v.console;d=/resolve/g;g="1.3.0";y=x;z={};u=function(F){return{}.toString.call(F)};function c(F){return u(F)==="[object Function]"}function p(F){return u(F)==="[object Array]"}function a(F){y=F}function t(G,F){return[].slice.call(G,F||0)}function w(F,G){return F.hasOwnProperty(G)}function k(G,I,H,F){G[I]=(function(K,J){return function(){var M=t(arguments,0);try{return J.apply(this,M)}catch(L){B.log(H,K,L)}finally{M=m}}}(I,F))}function l(G,I){var H,F;H=n[G].creator(I);F=H.init;H.__action__=I;H.oEventsCallbacks=H.oEventsCallbacks||{};H.aListeningEvents=(function(){var K=H.oEventsCallbacks,L,J=[];for(L in K){if(K.hasOwnProperty(L)){J.push(L)}}K=L=null;return J}());H.init=function(){I.listen(this.aListeningEvents,this.handleAction,this);F.call(this,arguments)};H.handleAction=function(K){var J=this.oEventsCallbacks[K.type];if(J===s){return}J.call(this,K)};H.onDestroy=H.onDestroy||function(){};H.destroy=function(){this.onDestroy();I.stopListen(this.aListeningEvents,this)};return H}function o(H){var J,G,I,F;if(n[H]===s){throw new Error("The module is not registered!")}J=new f();I="";F=function(){};G=l(H,J);if(!y){for(I in G){if(w(G,I)){F=G[I];if(!c(F)){continue}k(G,I,H,F)}}}try{return G}finally{J=m;G=m;I=m;F=m}}B=function(){};B.type="ErrorHandler";B.list=m;B.create_dom=function(){var F,H,G;F=C.createElement("div");H=C.createElement("ul");G=F.style;this.list=H;G.display="none";G.position="fixed";G.height="100px";G.width="100%";G.bottom="0px";F.appendChild(H);C.body.appendChild(F);F=m;H=m;G=m};B.addItem=function(G,F,H){var I;I=C.createElement("li");I.appendChild(C.createTextNode(G+"/"+F+": "+H.message));this.list.appendChild(I);I=m};B.log=function(){var F;F=t(arguments,0).concat();if(i===s||(typeof F[F.length-1]==="boolean"&&!F[F.length-1])){if(this.list===m){this.create_dom()}this.addItem.apply(this,F);B.__old_log__=B.log;this.log=function(){var G=t(arguments,0).concat();this.addItem.apply(this,G);G=m}}else{i.log.apply(i,F);B.__old_log__=B.log;this.log=function(){var G=t(arguments,0).concat();i.log.apply(i,G);G=m}}F=m};E=function(){};E.prototype={type:"Module",register:function(G,F){n[G]={creator:F,instances:{}};return n[G]},_merge:function(K,F,I){var G,J,H;G={};H=function(L){return function(){var M=t(arguments,0);L.apply(this,M)}};if(I){G.__super__={};G.__super__.__instance__=K;G.__super__.__call__=function(M,N){var L=this;while(w(L,M)===x){L=L.__instance__.__super__}L[M].apply(G,N)}}for(J in K){if(w(K,J)){if(J==="__super__"){continue}G[J]=K[J]}}for(J in F){if(w(F,J)){if(G.__super__!==s&&c(G[J])){G.__super__[J]=(H(G[J]));G[J]=F[J]}else{G[J]=F[J]}}}try{return G}finally{G=m;J=m}},extend:function(L,H,J){var G,K,O,I,M,F,N;G=n[L];K=L;O=function(P){return P};if(typeof H==="string"){K=H;O=J}else{O=H}if(G===s){return}N=new f();M=O(N);I=G.creator(N);F=this._merge(I,M,(K!==L));F.__action__=N;n[K]={creator:(function(P){return function(){return P}}(F)),instances:{}};G=m;K=m;O=m;I=m;M=m;F=m;N=m},test:function(F,G){if(jstestdriver){a(h);G(o(F));a(x)}},getModule:function(H,G){var I=n[H],F;if(jstestdriver){F=o(H);I.instances[G]=F;return I}return null},start:function(H,G,K,J){var I,F;I=n[H];if(J&&this.isModuleStarted(H,G)){this.stop(H,G)}if(I!==s){F=o(H);I.instances[G]=F;F.__container__=C.getElementById(G);F.init(K)}I=m;return F},isModuleStarted:function(G,F){return(typeof n[G]!==s&&n[G].instances[F]!==s)},startAll:function(){var F,G;for(F in n){if(w(n,F)){G=n[F];if(G!==s){this.start(F,Math.random())}}}F=m},stop:function(H,G){var I,F;I=n[H];if(I===s){return false}F=I.instances[G];if(I!==s&&F!==s){F.destroy()}I=F=m},stopAll:function(){var G,H,F;for(G in n){if(w(n,G)){H=n[G];if(H!==s){for(F in H.instances){if(w(H.instances,F)){this.stop(G,F)}}}}}G=m},_delete:function(F){if(n[F]!==s){delete n[F]}},remove:function(F){var G=n[F];if(G===s){return null}if(G!==s){try{return G}finally{G=m;this._delete(F)}}}};f=function(){};f.prototype={type:"Action",listen:function(J,H,K){var G,F,I;G="";I=J.length;for(F=0;F<I;F=F+1){G=J[F];if(z[G]===s){z[G]=[]}z[G].push({module:K,handler:H})}},notify:function(I){var K,J,F,H,G;K=I.type;J=m;if(z[K]===s){return}F=z[K].slice();G=F.length;for(H=0;H<G;H=H+1){J=F[H];J.handler.call(J.module,I)}K=m;F=m;H=m;G=m;J=m},stopListen:function(M,K){var G,J,F,I,L,H;G="";J=[];I=M.length;L=0;H=0;for(F=0;F<I;F=F+1){J=[];G=M[F];H=z[G].length;for(L=0;L<H;L=L+1){if(K!==z[G][L].module){J.push(z[G][L])}}z[G]=J;if(z[G].length===0){delete z[G]}}G=m;J=m;F=m;I=m;L=m;H=m},__restore__:function(){z={}}};e=function(){this.aPending=[];this.bCompleted=x;this.sType="";this.oResult=m;this.oAction=q.action();this.resolve=(function(F){return function(G){F.bCompleted=h;F.sType="resolve";F.oResult=G;F.oAction.notify({type:"complete"})}}(this));this.reject=(function(F){return function(G){F.bCompleted=h;F.sType="reject";F.oResult=G;F.oAction.notify({type:"complete"})}}(this))};e.prototype.then=function(F,G){this.aPending.push({resolve:F,reject:G});return this};b=function(){this.aPromises=[];this.aPending=[];this.sType="";this.oAction=q.action();this.oAction.listen(["complete"],this.checkCompleted,this)};b.prototype={add:function(F){this.aPromises.push(F);return this},checkCompleted:function(){var H,F,G;F=this.aPromises.length;G=m;for(H=0;H<F;H++){G=this.aPromises[H];if(!G.bCompleted){return x}}this.complete(this.getType());H=m;F=m;G=m},getType:function(){var I,G,H,F,J;G=this.aPromises.length;H=m;F=[];for(I=0;I<G;I++){H=this.aPromises[I];if(H.bCompleted){F.push(H.sType)}}if(F.length===0){return""}J=F.join("").replace(d,"").length>0?"reject":"resolve";try{return J}finally{I=m;G=m;H=m;F=m}},complete:function(I){var H,F,G;if(I.length===0){return x}F=this.aPromises.length;for(H=0;H<F;H++){G=this.aPromises[H];while(G.aPending[0]){G.aPending.shift()[I](G.oResult)}}while(this.aPending[0]){this.aPending.shift()[I]()}H=m;F=m;G=m},then:function(F,G){this.aPending.push({resolve:F,reject:G});return this}};r=function(){var J,H,I,F,G;J=t(arguments,0);I=J.length;G=m;this.oDeferred=F=new b();for(H=0;H<I;H++){G=J[H];if(G instanceof e){F.add(G)}else{F.complete("resolved");return}}try{return F}finally{J=m;H=m;I=m;G=m}};function j(){return B}function A(F){B=F}q=function(){};q.version=g;q.action=function(){return new f()};q.errorHandler=j;q.setErrorHandler=A;q.module=new E();q.setDebug=a;q.deferred=b;q.promise=e;q.when=r;D.Hydra=q}(this));