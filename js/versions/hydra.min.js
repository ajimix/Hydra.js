(function(g,r){var j,f,l,n,q,s,e,o,d,b,m;j={};l=null;f="1.2.0";n=false;q=function(){};s=function(){};e=function(){};o={};function c(t){return Object.prototype.toString.call(t)==="[object Function]"}function i(u,w,v,t){u[w]=(function(y,x){return function(){var A=[].slice.call(arguments,0);try{return x.apply(this,A)}catch(z){q.log(v,y,z)}finally{A=null}}}(w,t))}function k(v){if(typeof j[v]==="undefined"){throw new Error("The module is not registered!")}var x,u,w,t;x=new e();u=j[v].creator(x);w="";t=function(){};u.__action__=x;if(!n){for(w in u){if(u.hasOwnProperty(w)){t=u[w];if(!c(t)){continue}i(u,w,v,t)}}}return u}q.type="ErrorHandler";q.list=null;q.create_dom=function(){var t=r.createElement("div"),v=r.createElement("ul"),u=t.style;u.display="none";u.position="fixed";u.height="100px";u.width="100%";u.bottom="0px";this.list=v;t.appendChild(v);r.body.appendChild(t);t=v=null;u=null};q.addItem=function(u,t,v){var w=r.createElement("li");w.appendChild(r.createTextNode(u+"/"+t+": "+v.message));this.list.appendChild(w);w=null};q.log=function(){var t=[].slice.call(arguments,0).concat();if(typeof g.console==="undefined"||(typeof t[t.length-1]==="boolean"&&!t[t.length-1])){if(this.list===null){this.create_dom()}this.addItem.apply(this,t);q.__old_log__=q.log;this.log=function(){var u=[].slice.call(arguments,0).concat();this.addItem.apply(this,u);u=null}}else{g.console.log.apply(g.console,t);q.__old_log__=q.log;this.log=function(){var u=[].slice.call(arguments,0).concat();g.console.log.apply(g.console,u);u=null}}t=null};s.prototype.type="Module";s.prototype.register=function(u,t){j[u]={creator:t,instance:null}};s.prototype._merge=function(y,t,w){var u={},x="";if(w){u.__super__={};u.__super__.__instance__=y;u.__super__.__call__=function(A,B){var z=this;while(z.hasOwnProperty(A)===false){z=z.__instance__.__super__}z[A].apply(u,B)}}for(x in y){if(y.hasOwnProperty(x)){if(x==="__super__"){continue}u[x]=y[x]}}function v(z){return function(){var A=[].slice.call(arguments,0);z.apply(this,A)}}for(x in t){if(t.hasOwnProperty(x)){if(typeof u.__super__!=="undefined"&&Object.prototype.toString.call(u[x])==="[object Function]"){u.__super__[x]=(v(u[x]));u[x]=t[x]}else{u[x]=t[x]}}}return u};s.prototype.extend=function(z,v,x){var u=j[z],y=z,C=function(D){return D},w=null,A=null,t=null,B=null;if(typeof v==="string"){y=v;C=x}else{C=v}if(typeof u==="undefined"){return}B=new e();A=C(B);w=u.creator(B);t=this._merge(w,A,(y!==z));t.__action__=B;j[y]={creator:function(){return t},instance:null}};s.prototype.test=function(t,u){n=true;u(k(t));n=false};s.prototype.start=function(t,w,v){var u=j[t];if(v&&this.isModuleStarted(t)){this.stop(t)}if(typeof u!=="undefined"){u.instance=k(t);u.instance.init(w)}u=null};s.prototype.isModuleStarted=function(t){return("undefined"!==typeof j[t]&&null!==j[t].instance)};s.prototype.startAll=function(){var t="";for(t in j){if(j.hasOwnProperty(t)){this.start(t)}}t=null};s.prototype.stop=function(t){var u=j[t];if(typeof u!=="undefined"&&u.instance!==null){u.instance.destroy();u.instance=null}};s.prototype.stopAll=function(){var t="";for(t in j){if(j.hasOwnProperty(t)){this.stop(t)}}t=null};s.prototype._delete=function(t){delete j[t]};s.prototype.remove=function(t){var u=j[t];if(typeof u!=="undefined"){j[t]=null;this._delete(t)}};e.prototype.type="Action";e.prototype.listen=function(x,v,y){var u="",t=0,w=x.length;for(t=0;t<w;t=t+1){u=x[t];if(typeof o[u]==="undefined"){o[u]=[]}o[u].push({module:y,handler:v})}};e.prototype.notify=function(v){var x=v.type,w=null,u=0,t=0;if(typeof o[x]==="undefined"){return}t=o[x].length;for(u=0;u<t;u=u+1){w=o[x][u];w.handler.call(w.module,v)}x=null;u=t=null;w=null};e.prototype.stopListen=function(A,y){var u="",x=[],t=0,w=A.length,z=0,v=0;for(t=0;t<w;t=t+1){x=[];u=A[t];v=o[u].length;for(z=0;z<v;z=z+1){if(y!==o[u][z].module){x.push(o[u][z])}}o[u]=x;if(o[u].length===0){delete o[u]}}};e.prototype.__restore__=function(){o={}};d=function(){var t=this;this.aPending=[];this.bCompleted=false;this.sType="";this.oResult=null;this.oAction=l.action();this.resolve=function(u){t.bCompleted=true;t.sType="resolve";t.oResult=u;t.oAction.notify({type:"complete"})};this.reject=function(u){t.bCompleted=true;t.sType="reject";t.oResult=u;t.oAction.notify({type:"complete"})}};d.prototype.then=function(t,u){this.aPending.push({resolve:t,reject:u});return this};b=function(){this.aPromises=[];this.aPending=[];this.sType="";this.oAction=l.action();this.oAction.listen(["complete"],this.checkCompleted,this)};b.prototype.add=function(t){this.aPromises.push(t);return this};b.prototype.checkCompleted=function(){var v=0;var t=this.aPromises.length;var u=null;for(;v<t;v++){u=this.aPromises[v];if(!u.bCompleted){return false}}this.complete(this.getType())};b.prototype.getType=function(){var x=0;var u=this.aPromises.length;var w=null;var t=[];var v="";for(;x<u;x++){w=this.aPromises[x];if(w.bCompleted){t.push(w.sType)}}if(t.length===0){return""}return t.join("").replace(/resolve/g,"").length>0?"reject":"resolve"};b.prototype.complete=function(w){if(w.length===0){return false}var v=0;var t=this.aPromises.length;var u=null;for(v=0;v<t;v++){u=this.aPromises[v];while(u.aPending[0]){u.aPending.shift()[w](u.oResult)}}while(this.aPending[0]){this.aPending.shift()[w]()}};b.prototype.then=function(t,u){this.aPending.push({resolve:t,reject:u});return this};m=function(){this.oDeferred=new b();var w=[].slice.call(arguments);var u=0;var v=w.length;var t=null;for(;u<v;u++){t=w[u];if(t instanceof d){this.oDeferred.add(t)}else{this.oDeferred.complete("resolved");return}}return this.oDeferred};function h(){return q}function p(t){q=t}function a(t){n=t}l={action:function(){return new e()},errorHandler:h,setErrorHandler:p,module:new s(),setDebug:a,deferred:b,promise:d,when:m};g.Hydra=l}(window,document));